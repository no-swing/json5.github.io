function setAbiCookie(key, value) {
  var date = new Date();
  var expiresDays = 1;
  date.setTime(date.getTime() + expiresDays * 24 * 3600 * 1000);
  document.cookie = key + '=' + value + ';path=/;domain=.huaweicloud.com;expires=' + date.toGMTString();
}
function ruleBpName(value) {
  var reg = /^[A-Za-z0-9]+$/;
  if (!reg.test(value)) {
    return false;
  }
  return true;
}
function ruleBindType(value) {
  var reg = /^\d+$/;
  if (!reg.test(value)) {
    return false;
  }
  return true;
}
function parseParams() {
  var baseUrl = window.location.origin + window.location.pathname;
  var paramsStr = window.location.search;
  if (paramsStr.substr(0, 1) == '?') {
    paramsStr = paramsStr.substr(1);
  }
  if (null != paramsStr) {
    var params = paramsStr.split('&');
    for (i = 0; i < params.length; i++) {
      var param = params[i].split('=');
      if (param.length > 1 && 'bpName' == param[0] && ruleBpName(param[1])) {
        var bpName = param[1];
      }
      if (param.length > 1 && 'bindType' == param[0] && ruleBindType(param[1])) {
        var bindType = param[1];
      }
      if (param.length > 1 && 'salesID' == param[0]) {
        var sid = param[1];
      }
      if (param.length > 1 && 'campaignID' == param[0]) {
        var campaignID = param[1];
      }
    }
    if (bpName && bindType) {
      var key = 'hw_abi';
      if (sid) {
        var value = '{"n":"' + bpName + '","t":' + bindType + ',"url":"' + baseUrl + '","sid":"' + sid + '","campaignID":"' + campaignID + '"}';
      } else {
        var value = '{"n":"' + bpName + '","t":' + bindType + ',"url":"' + baseUrl + '","campaignID":"' + campaignID + '"}';
      }
      setAbiCookie(key, value);
    }
    if (bpName) {
      setAbiCookie('hw_abi_n', bpName);
    }
  }
}

function getCookie(name) {
  try {
    var allcookies = document.cookie;
    name += '=';
    var pos = allcookies.indexOf(name);
    if (pos != -1) {
      var start = pos + name.length;
      var end = allcookies.indexOf(';', start);
      if (end == -1) end = allcookies.length;
      var value = allcookies.substring(start, end);
      return decodeURI(value);
    } else {
      return '';
    }
  } catch (e) {
    return '';
  }
}

function canAnalysis() {
  var site = document.getElementsByTagName('html')[0].getAttribute('site');
  var lang = document.getElementsByTagName('html')[0].getAttribute('lang');
  var regionsWithPolicy = ['tr-tr', 'th-th'];

  if (site === 'eu' || regionsWithPolicy.includes(lang)) {
    var hwcp_eu = getCookie('hwcp_eu');
    if (hwcp_eu) {
      try {
        var euObj = JSON.parse(hwcp_eu);
        return euObj.analysis == 1;
      } catch (e) {
        return false;
      }
    }
    return false;
  } else {
    return true;
  }
}

if (canAnalysis()) {
  parseParams();
}

// add by young
setTimeout(function(){
    if( location.href.indexOf('type=android')>-1 || location.href.indexOf('type=ios')>-1){
      $("#header").css("display","none");
      $("#footer").css("display","none");
    }
},1000)
